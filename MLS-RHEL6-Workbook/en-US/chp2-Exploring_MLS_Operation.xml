<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "MLS_RHEL6_Workbook.ent">
%BOOK_ENTITIES;
]>
<chapter id="chap-MLS_RHEL6_Workbook-Exploring_MLS_Operation">
	<title>Exploring MLS System Operation</title>
	<para>
		This lab will cover some of the principals of system operation in MLS. You will learn
how to gain administrative access, how to edit configuration files, schedule cron jobs, mount DVDs, add
users to an MLS system, lock and unlock user accounts, remove users, and defining administrative accounts on the system.
	</para>
	<section id="sect-MLS_RHEL6_Workbook-Exploring_MLS_Operation-AdminAccess">
		<title>Gain Administrative Access</title>
		<para>
			<table frame="void">
				<caption/>
				<col width="6%"/>
				<col width="94%"/>
				<thead>
					<tr>
						<th>Step</th>
						<th>Action</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>1</td>
						<td>On a normal system, to gain administrative access, we simply do:<para>su
								-</para><para>On your MLS system, login as your administrative user
								(a regular user with staff_r as their default role) and then try the
								above. You should see:</para><para>Always use '/bin/su -' (see
								Evaluated Configuration Guide)</para></td>
					</tr>
					<tr>
						<td>2</td>
						<td>On an MLS system, to gain administrative access, we need to
								do:<para>/bin/su -</para></td>
					</tr>
					<tr>
						<td>3</td>
						<td>At this point you should be logged in as root.
								Execute:<para>pwd</para><para>ls</para><para>You should se that you
								are in /root, but for some reason, root is getting a permission
								denied on listing /root.</para></td>
					</tr>
					<tr>
						<td>4</td>
						<td>The reason root is getting a permission denied is that while you are
							logged in as root, you also have the role of staff_r. In order to do
							system administration tasks, you need to switch to the role
								sysadm_r:<para>newrole -r sysadm_r</para><para>ls</para><para>You
								will be asked to authenticate yourself. You will need to enter your
								password, not root's password. Once you have finished this, the ls
								should work.</para></td>
					</tr>
					<tr>
						<td>5</td>
						<td>Let's try to add an audit watch on a file in root named <emphasis
								role="bold">donttouch</emphasis>:<para>auditctl -w /root/donttouch
								-p wa -k privileged_files</para><para>This will not work as you are
								only the system administrator, not the audit
							administrator!</para></td>
					</tr>
					<tr>
						<td>6</td>
						<td>Become the audit administrator:<para>newrole -r
								auditadm_r</para><para>Now add the rule:</para><para>auditctl -w
								/root/donttouch -p wa -k privileged_files</para></td>
					</tr>
					<tr>
						<td>7</td>
						<td>Search for any audited results matching our new rule:
							<para><programlisting><command># ausearch -k privileged_files</command></programlisting></para><para>You will end up getting something
								similar to this:</para><para>
									<programlisting>
Error opening config file (Permission denied)
NOTE - using built-in logs: /var/log/audit/audit.log
Error opening /var/log/audit/audit.log (Permission denied)</programlisting></para></td>
					</tr>
					<tr>
						<td>8</td>
						<td>In order to be able to use ausearch, we need to be in the role sysadm_r,
							not auditadm_r. Since we were just in the role sysadm_r, we can simply
								do:<para>exit</para><para>and we should then be back as sysadm_r. Do
								the following:</para><para><programlisting>
<command># touch /root/donttouch</command>
<command># ausearch -k privileged_files</command></programlisting></para></td>
					</tr>
				</tbody>
			</table>
		</para>
	</section>
	
	<section id="sect-MLS_RHEL6_Workbook-Exploring_MLS_Operation-EditConfig">
		<title>Editing Configuration Files</title>
		<para>
			<table frame="void">
				<caption/>
				<col width="6%"/>
				<col width="94%"/>
				<thead>
					<tr>
						<th>Step</th>
						<th>Action</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>1</td>
						<td>In an MLS system, the editor of choice is <emphasis role="italic"
								>rnano</emphasis>.<para><quote>"Other editors can read and execute commands
								specificed in run control files or in the edited files themselves or
								have other complex dependencies on the execution environment. That
								is a security risk and inappropriate for an editor used for system
								administration tasks. The rnano editor was tested and examined as
								part of the evaluation to ensure that it works as expected and is
								secure, this was not done for any of the other editors shipped with
								the system" --LSPP EAL4 Evaluated Configuration Guide for Red Hat
								Enterprise Linux on IBM Hardware</quote></para></td>
					</tr>
					<tr>
						<td>2</td>
						<td>To set the EDITOR variable, use rnano to edit /etc/profile and make sure that it reads as
							follows:<programlisting>if [ `id -u` -eq 0 ]; then
	EDITOR=rnano
	export EDITOR
fi</programlisting></td>
					</tr>
					<tr>
						<td>3</td>
						<td>To exit the rnano editor, simply hit Ctrl+X. You will be asked if you want to save your
							changes, and then if you do save your changes, you will be asked what
							file to save them to.</td>
					</tr>
					
				</tbody>
			</table>
		</para>
	</section>
	
	<section id="sect-MLS_RHEL6_Workbook-Exploring_MLS_Operation-Cron">
		<title>Scheduling Cron Jobs</title>
		<para> . . . </para>
	</section>

	<section id="sect-MLS_RHEL6_Workbook-Exploring_MLS_Operation-cdroms">
		<title>Mounting CD/DVD Media</title>
		<para> . . . </para>
	</section>

</chapter>
